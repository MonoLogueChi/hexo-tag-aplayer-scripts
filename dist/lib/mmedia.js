"use strict";var clone=function(t){return JSON.parse(JSON.stringify(t))},config_default=require("../config/config_default").config_default,Config=function(){function t(t){this.hexo=t,this.root=t.config.root||"/",t.config.mmedia&&this._parse(clone(t.config.mmedia))}return t.prototype._parse=function(t){config_default=utils.assign(config_default,t)},t}(),utils=require("utility");module.exports=function(t,n,e){switch(n[0]){case"audio":return new Audio0(t,n,e).generate();case"video":return new Video(t,n,e).generate();case"meting":return new Meting(t,n,e).generate()}};var BaseConfig=function(){},BaseMmedia=function(){function t(t,n,e){this.hexo=t,this.args=n,this.config=new Config(t)}return t.prototype.generate=function(){return""},t.prototype.extractOption=function(t){var n=t.indexOf(":"),e=t.indexOf("=");return e<n?[t.slice(0,t.indexOf(":")),t.slice(t.indexOf(":")+1)]:n<e?[t.slice(0,t.indexOf("=")),t.slice(t.indexOf("=")+1)]:void 0},t}(),BaseTag=function(){function t(t){this.mmedia_id=utils.randomString(12),this.tag_id="mmedia-"+this.mmedia_id}return t.prototype.parse=function(t){var n,e="";for(n in t)""!=n&&null!=n&&(t[n]?"true"===t[n]||"false"===t[n]||Number(t[n])+""!="NaN"?e+=n+"="+t[n]+" ":e+=n+'="'+t[n]+'" ':e+=n+" ");return e},t}(),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),Audio0=function(o){function t(t,n,e){e=o.call(this,t,n,e)||this;return e.audio_config=new AudioConfig,e}return __extends(t,o),t.prototype.generate=function(){var n=this;return this.args.forEach(function(t){t=n.extractOption(t);t&&(n.audio_config.data[t[0]]=t[1])}),new AudioTag(this.audio_config).generate()},t}(BaseMmedia),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),AudioConfig=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.data=config_default.audio.default||{},t}return __extends(t,n),t}(BaseConfig),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),AudioTag=function(e){function t(t){var n=e.call(this,t)||this;return n.config=t,n.result="",n}return __extends(t,e),t.prototype.generate=function(){var t=this.config.data,t='<audio id="'+this.tag_id+'" '+this.parse(t)+"></audio>";return this.result+=t,this.result},t}(BaseTag),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),Meting=function(o){function t(t,n,e){e=o.call(this,t,n,e)||this;return e.meting_config=new MetingConfig,e}return __extends(t,o),t.prototype.generate=function(){var n=this;return this.args.forEach(function(t){t=n.extractOption(t);t&&(n.meting_config.data[t[0]]=t[1])}),new MetingTag(this.meting_config).generate()},t}(BaseMmedia),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),MetingConfig=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.aplayer_css=config_default.aplayer.css,t.aplayer_js=config_default.aplayer.js,t.meting_js=config_default.meting.js,t.meting_api="",t.data=config_default.meting.default||{},t}return __extends(t,n),t}(BaseConfig),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),MetingTag=function(e){function t(t){var n=e.call(this,t)||this;return n.config=t,n.result="",n}return __extends(t,e),t.prototype.generate=function(){this.result+='<link rel="stylesheet" href="'+this.config.aplayer_css+'">',this.result+='<script src="'+this.config.aplayer_js+'"><\/script>',this.result+='<script src="'+this.config.meting_js+'"><\/script>',""!=this.config.meting_api&&(t="var meting_api='"+this.config.meting_api+"?server=:server&type=:type&id=:id&auth=:auth&r=:r';",this.result+="<script> "+t+" <\/script>");var t=this.config.data,t="<meting-js "+this.parse(t)+"></meting-js>";return this.result+=t,this.result},t}(BaseTag),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),Video=function(o){function t(t,n,e){e=o.call(this,t,n,e)||this;return e.video_config=new VideoConfig,e}return __extends(t,o),t.prototype.generate=function(){var n=this;return this.args.forEach(function(t){t=n.extractOption(t);t&&(n.video_config.data[t[0]]=t[1])}),new VideoTag(this.video_config).generate()},t}(BaseMmedia),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),VideoConfig=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.data=config_default.video.default||{},t}return __extends(t,n),t}(BaseConfig),__extends=this&&this.__extends||function(){var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)};return function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}(),VideoTag=function(e){function t(t){var n=e.call(this,t)||this;return n.config=t,n.result="",n}return __extends(t,e),t.prototype.generate=function(){var t=this.config.data,t='<video id="'+this.tag_id+'" '+this.parse(t)+"></video>";return this.result+=t,this.result},t}(BaseTag);